v2:~(|package-named--is @table ~(_bind--to @get-value-for-key--in-table &" key table()"(|~(_let--be @reclookup &" temptable()"(|~(|if--then ~(_not ~(_is-empty @temptable_)_) ~(|begin ~(_let--be @entry ~(_head @temptable_)_) ~(_let--be @thiskey ~(_head @entry_)_) ~(_let--be @value ~(_head ~(_tail @entry_)_)_) ~(|if--then--else ~(_equal @key @thiskey_) @value ~(_reclookup ~(_tail @temptable_)_)|)|)|)|)_) ~(_reclookup @table_)|)_) ~(_bind--to @remove-all-entries-with-key--from-table &"() key table()"(|~(|reduce--with--given @table &" item accum()"(|~(|if--then--else ~(_equal @key ~(_head @item_)_) @accum ~(_push--into @item @accum_)|)|) (||)|)|)_) ~(_bind--to @add-key--and-value--to-table &" key value table()"(|~(_push--into ~(_push--into @key ~(_push--into @value (||)_)_) @table_)|)_) ~(_bind--to @is-key--in-table &"! key table()"(|~(_list--contains-item-satisfying @table &" entry"(|~(_equal @key ~(_head @entry_)_)|)_)|)_)|)