v2:~(|package @table ~(_import @traversal-functions_) ~"bind to"(_@get-value &" key table()"(|~"let be"(_@reclookup &" temptable()"(|~"if then else"(|~(_not ~(_is-empty @temptable_)_) ~(|begin ~"let be"(_@entry ~(_head @temptable_)_) ~"let be"(_@thiskey ~(_head @entry_)_) ~"let be"(_@value ~(_head ~(_tail @entry_)_)_) ~"if then else"(|~(_equal @key @thiskey_) @value ~(_reclookup ~(_tail @temptable_)_)|)|) !no|)|)_) ~(_reclookup @table_)|)_) ~"bind to"(_@remove-entries &"() key table()"(|~"reduce with"(|@table &" item accum()"(|~"if then else"(|~(_equal @key ~(_head @item_)_) @accum ~"push into"(_@item @accum_)|)|) (||)|)|)_) ~"bind to"(_@add-key--value--to &"() key value table()"(|~"push into"(_~"push into"(_@key ~"push into"(_@value (||)_)_) @table_)|)_) ~"bind to"(_@is-key--in &"! key table()"(|~"traversal:in is-there-a"(_@table &" entry"(|~(_equal @key ~(_head @entry_)_)|)_)|)_)|)