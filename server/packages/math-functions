v2:~(|package @math ~(_import @table-functions_) ~(_import @vector-functions_) ~"bind to"(_@sum &"#% lst()"(|~"if then else"(|~(_is-empty @lst_) #0 ~(_::pl:: ~(_head @lst_) ~(_sum ~(_tail @lst_)_)_)|)|)_) ~"bind to"(_@min &" a b"(|~"if then else"(_~(_::lt:: @a @b_) @a @b_)|)_) ~"bind to"(_@max &" a b"(|~"if then else"(_~(_::gt:: @a @b_) @a @b_)|)_) ~(_bind @abs &"a#%"(|~"if then else"(_~(_::lt:: @a %0.0_) ~(_- @a_) @a_)|)_) ~"bind to"(_@hex-string-of &" n"(|~"let be"(_@map [word](_[word](_#10 $"a"_) [word](_#11 $"b"_) [word](_#12 $"c"_) [word](_#13 $"d"_) [word](_#14 $"e"_) [word](_#15 $"f"_)_)_) ~"let be"(_@string-for-digit &" digit-in-decimal"(|~"if then else"(|~(_::lte:: @digit-in-decimal #9_) ~(_to-string @digit-in-decimal_) ~(_table:get-value @digit-in-decimal @map_)|)|)_) ~"let be"(_@do-entire-number &" num"(|~"let be"(_@least-sig-digit ~(_modulo @num #16_)_) ~"let be"(_@remaining ~"if then else"(|~(_::eq:: #0 ~(_- @num @least-sig-digit_)_) #0 ~(_::ov:: ~(_- @num @least-sig-digit_) #16_)|)_) ~(|string-concatenate ~"if then else"(|~(_::eq:: #0 @remaining_) $ ~(_do-entire-number @remaining_)|) ~(_string-for-digit @least-sig-digit_)|)|)_) ~(_do-entire-number @n_)|)_) ~"bind to"(_@random-float-between--and &" start#% end#%"(|~"let be"(_@rand ~(_::ti:: ~(_random _) ~(_- ~(_to-float @end_) ~(_to-float @start_)_)_)_) ~"if then else"(|~(_or ~(_is-float @start_) ~(_is-float @end_)_) ~(_::pl:: @start @rand_) ~(_::pl:: @start ~(_to-integer @rand_)_)|)|)_) ~"bind to"(_@random-boolean &(|~"let be"(_@rand ~(_random _)_) ~(_::lt:: @rand %0.5_)|)_) ~"bind to"(_@runge-kutta &"% f& yn% h%"(|[doc](|[line](_[word](_[letter]"N" [letter]"o" [letter]"t" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"f"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"o" [letter]"u" [letter]"l" [letter]"d"_) [separator]" " [word](_[letter]"b" [letter]"e"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"f" [letter]"u" [letter]"n" [letter]"c" [letter]"t" [letter]"i" [letter]"o" [letter]"n"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"y"_) [separator]"," [separator]" " [word](_[letter]"t"_) [separator]" " [word](_[letter]"n" [letter]"o" [letter]"t"_) [separator]" " [word](_[letter]"s" [letter]"u" [letter]"p" [letter]"p" [letter]"o" [letter]"r" [letter]"t" [letter]"e" [letter]"d"_) [separator]"."_)|) ~"let be"(_@k1 ~(_f @yn_)_) ~"let be"(_@k2 ~(_f ~(_::pl:: @yn ~(_::ti:: @h ~(_::ov:: @k1 %2_)_)_)_)_) ~"let be"(_@k3 ~(_f ~(_::pl:: @yn ~(_::ti:: @h ~(_::ov:: @k2 %2_)_)_)_)_) ~"let be"(_@k4 ~(_f ~(_::pl:: @yn ~(_::ti:: @h @k3_)_)_)_) ~(|::pl:: @yn ~(|::ti:: ~(_::ov:: %1 %6_) @h ~(|::pl:: @k1 ~(_::ti:: %2 @k2_) ~(_::ti:: %2 @k3_) @k4|)|)|)|)_) ~"bind to"(_@runge-kutta-vector &" f& yn h%"(|[doc](|[line](_[word](_[letter]"C" [letter]"a" [letter]"l" [letter]"c" [letter]"u" [letter]"l" [letter]"a" [letter]"t" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"n" [letter]"e" [letter]"x" [letter]"t"_) [separator]" " [word](_[letter]"v" [letter]"a" [letter]"l" [letter]"u" [letter]"e"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"f"_) [separator]" " [word](_[letter]"a" [letter]"k" [letter]"a"_) [separator]" " [word](_[letter]"d" [letter]"v" [letter]"d" [letter]"t"_) [separator]"," [separator]" " [word](_[letter]"g" [letter]"i" [letter]"v" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"y" [letter]"s" [letter]"u" [letter]"b" [letter]"m"_) [separator]" " [separator]"-" [separator]" " [word](_[letter]"a" [letter]"k" [letter]"a"_) [separator]" " [word](_[letter]"v" [letter]"s" [letter]"u" [letter]"b" [letter]"m"_) [separator]" " [separator]"-" [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"e" [letter]"p"_) [separator]" " [word](_[letter]"v" [letter]"a" [letter]"l" [letter]"u" [letter]"e"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"h"_) [separator]"." [separator]" " [word](_[letter]"y" [letter]"s" [letter]"u" [letter]"b" [letter]"n"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"o" [letter]"u" [letter]"l" [letter]"d"_) [separator]" " [word](_[letter]"b" [letter]"e"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"V" [letter]"e" [letter]"c" [letter]"t" [letter]"o" [letter]"r" [letter]"3" [letter]"d"_)_)|) ~"let be"(_@k1 ~(_f @yn_)_) ~"let be"(_@k2 ~(_f ~(_yn.add ~(_.scale ~(_k1.scale %0.5_) @h_)_)_)_) ~"let be"(_@k3 ~(_f ~(_yn.add ~(_.scale ~(_k2.scale %0.5_) @h_)_)_)_) ~"let be"(_@k4 ~(_f ~(_yn.add ~(_k3.scale @h_)_)_)_) ~(|yn.add ~(|.scale ~(|vector:add-3d @k1 ~(_k2.scale %2.0_) ~(_k3.scale %2.0_) @k4|) ~(_::ti:: ~(_::ov:: %1 %6_) @h_)|)|)|)_) ~"bind to"(_@lorenz &" v h%"(|[doc](|[line](_[word](_[letter]"v"_) [separator]" " [word](_[letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"i" [letter]"t" [letter]"i" [letter]"a" [letter]"l"_) [separator]" " [word](_[letter]"c" [letter]"o" [letter]"n" [letter]"d" [letter]"i" [letter]"t" [letter]"i" [letter]"o" [letter]"n"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"h"_) [separator]" " [word](_[letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"e" [letter]"p"_)_)|) ~"let be"(_@dxdt &" v"(|~"let be"(_@sigma %10_) ~"let be"(_@rho %28_) ~"let be"(_@beta ~(_::ov:: %8 %3_)_) ~"let be"(_@xval ~(_::ti:: @sigma ~(_- @v.y @v.x_)_)_) ~"let be"(_@yval ~(_- ~(_::ti:: @v.x ~(_- @rho @v.z_)_) @v.y_)_) ~"let be"(_@zval ~(_- ~(_::ti:: @v.x @v.y_) ~(_::ti:: @beta @v.z_)_)_) ^"vector:Vector3d"(_@xval @yval @zval_)|)_) ~(_runge-kutta-vector @dxdt @v @h_)|)_)|)