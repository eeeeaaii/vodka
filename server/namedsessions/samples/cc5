v2:~(|begin ~(_import @style-functions_) ~(_import @list-functions_) ~(_bind @makeletter &" lt value"(|~(_let @container ~"style:set-width-for to"(_~"style:set-height-for to"(_[word](__) ~(_::ov:: #500 @dim_)_) ~(_::ov:: #500 @dim_)_)_) ~(_let @val ~(_to-integer ~(_::ti:: ~(_::ov:: #750 @dim_) ~(_::ov:: ~(_to-float @value_) %255_)_)_)_) ~(_cons ~"style:set-font-for to"(_~"style:set-font-size-for to"(_@lt @val_) $"Courier"_) @container_)|)_) ~(_bind @color-to-letter &" color"(|~(_let @r ~(_first @color_)_) ~(_let @g ~(_first ~(_rest @color_)_)_) ~(_let @b ~(_first ~(_rest ~(_rest @color_)_)_)_) ~(|case ~(_if ~(_and ~(_::gt:: @r @g_) ~(_::gt:: @r @b_)_) ~(_makeletter [letter]"r" @r_)_) ~(_if ~(_and ~(_::gt:: @g @r_) ~(_::gt:: @g @b_)_) ~(_makeletter [letter]"g" @g_)_) ~(_if ~(_and ~(_::gt:: @b @r_) ~(_::gt:: @b @g_)_) ~(_makeletter [letter]"b" @b_)_) ~(_if ~(_and ~(_::eq:: @r @g_) ~(_::eq:: @r @b_)_) ~(_makeletter [letter]"x" @r_)_) ~(_if ~(_::eq:: @r @g_) ~(_makeletter [letter]"y" @r_)_) ~(_if ~(_::eq:: @r @b_) ~(_makeletter [letter]"m" @r_)_) ~(_if ~(_::eq:: @g @b_) ~(_makeletter [letter]"c" @g_)_)|)|)_) ~(_bind @cc5 &"dimension"(|*"begin"(|~(_bind @dim @dimension_) ~(_setup _) ~(_canvas-grab _) ~(_wait-for-delay #500_) ~(_drawletters _)|)|)_) ~(_bind @canvas-grab &(|~(_copy-from-clipboard @c_)|)_) ~(_bind @setup &(|~(_bind @c ~(_make-surface @dim @dim_)_)|)_) ~(_bind @drawletters &(|~(_let @result [doc](||)_) ~"loop over"(|&" i"(|~(_let @currentlist [line](__)_) ~"loop over"(|&" j"(|~(_cram ~(_color-to-letter ~(_color-at @c @j @i_)_) @currentlist_)|) ~(_list:reverse ~(_range #0 @dim_)_)|) ~(_cram @currentlist @result_)|) ~(_list:reverse ~(_range #0 @dim_)_)|) @result|)_)|)