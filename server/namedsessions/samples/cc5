v2:~(|begin ~(_import @style-functions_) ~(_bind @makeletter &" lt value"(|~(_bind @container ~(_style:with-width-of ~(_style:with-height-of [word](__) #10_) #10_)_) ~(_let @val ~(_to-integer ~(_::ti:: %30 ~(_::ov:: ~(_to-float @value_) %255_)_)_)_) ~(_cons ~(_style:with-text-in-size @lt @val_) @container_)|)_) ~(_bind @makeletter &" lt value"(|@lt|)_) ~(_bind @color-to-letter &" color"(|~(_let @r ~(_first @color_)_) ~(_let @g ~(_first ~(_rest @color_)_)_) ~(_let @b ~(_first ~(_rest ~(_rest @color_)_)_)_) ~(|case ~(_if ~(_and ~(_::gt:: @r @g_) ~(_::gt:: @r @b_)_) ~(_makeletter [letter]"r" @r_)_) ~(_if ~(_and ~(_::gt:: @g @r_) ~(_::gt:: @g @b_)_) ~(_makeletter [letter]"g" @g_)_) ~(_if ~(_and ~(_::gt:: @b @r_) ~(_::gt:: @b @g_)_) ~(_makeletter [letter]"b" @b_)_) ~(_if ~(_and ~(_::eq:: @r @g_) ~(_::eq:: @r @b_)_) ~(_makeletter [letter]"x" @r_)_) ~(_if ~(_::eq:: @r @g_) ~(_makeletter [letter]"y" @r_)_) ~(_if ~(_::eq:: @r @b_) ~(_makeletter [letter]"m" @r_)_) ~(_if ~(_::eq:: @g @b_) ~(_makeletter [letter]"c" @g_)_)|)|)_) ~(_bind @cc5 &(|~(_setup _) ~(_canvas-grab _) ~(_drawletters _)|)_) ~(_bind @canvas-grab &(|~(_@<`copy-from-clipboard`>c_)|)_) ~(_bind @setup &(|~(_bind @c ~(_instantiate [nil]<`Canvas`> #50 #50_)_)|)_) ~(_bind @drawletters &(|~(_let @result [doc](||)_) ~(|loop-over &" i"(|~(_let @currentlist [line](__)_) ~(|loop-over &" j"(|~(_cram ~(_color-to-letter ~(_@<`color-at`>c @i @j_)_) @currentlist_)|) ~(_range #0 #50_)|) ~(_cram @currentlist @result_)|) ~(_range #0 #50_)|) @result|)_)|)