v2:~(|with-imports @animation-functions @vector-functions @util-functions @style-functions ~(|begin [doc](_[line](_[word](_[letter]"P" [letter]"o" [letter]"e" [letter]"m"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"u" [letter]"f" [letter]"f"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"l" [letter]"o" [letter]"w"_) [separator]"."_)_) ~(_bind @poemtext [doc](_[line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x" [letter]"e" [letter]"s"_)_) [line](_[word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"e" [letter]"v" [letter]"e" [letter]"r" [letter]"y"_) [separator]" " [word](_[letter]"d" [letter]"a" [letter]"y"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"r" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"s" [letter]"i" [letter]"d" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"s" [letter]"i" [letter]"d" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"p" [letter]"l" [letter]"a" [letter]"c" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"n" [letter]"e" [letter]"v" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"g" [letter]"o"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"y" [letter]"w" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_)_) [line](_[word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"h" [letter]"e" [letter]"l" [letter]"l" [letter]"o"_)_) [line](_[word](_[letter]"I" [letter]"'" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"r" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"y" [letter]"u" [letter]"p"_)_) [line](_[word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"h" [letter]"e" [letter]"l" [letter]"l" [letter]"o"_)_) [line](_[word](_[letter]"I" [letter]"'" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"n" [letter]"o" [letter]"t"_) [separator]" " [word](_[letter]"g" [letter]"o" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"y" [letter]"w" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"n" [letter]"o" [letter]"p" [letter]"e"_)_) [line](_[word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_)_)_) ~(_bind @numpoemlines ~(_util:length-of @poemtext_)_) ~(_bind @setup-text &(|~(_bind @textsurface ~(|style:with-width-of ~(|style:with-height-of ~(_make-zlist _) @canvasheight|) @canvaswidth|)_) ~(_bind @right-container ~(_style:rotate-by [doc](__) %90_)_) ~(_bind @top-container ~(_copy [doc](__)_)_) ~(_bind @left-container ~(_style:rotate-by [doc](__) %-90_)_) ~(_bind @bottom-container ~(_style:rotate-by [doc](__) %180_)_) ~(_cram ~(_cram ^ @right-container_) @textsurface_) ~(_cram ~(_cram ^ @top-container_) @textsurface_) ~(_cram ~(_cram ^ @left-container_) @textsurface_) ~(_cram ~(_cram ^ @bottom-container_) @textsurface_)|)_) ~(_bind @format-text &" txt"(|~(_let @t ~(_ff ~(_animation:fade-out-for-seconds ~(|style:uppercased ~(|style:with-font ~(|style:with-text-in-size ~(_style:with-text-in-color @txt $"#ffffff"_) #35|) $"Helvetica"|)|) %3_)_)_) ~(_let @c ~(_style:push-center ~(_style:with-width-of [line](__) @canvaswidth_)_)_) ~(_cons @t @c_)|)_) ~(_bind @set-right-text &" text"(|~(_chop @right-container_) ~(_cram ~(_format-text @text_) @right-container_) ~(_force-draw @textsurface_)|)_) ~(_bind @set-top-text &" text"(|~(_chop @top-container_) ~(_cram ~(_format-text @text_) @top-container_) ~(_force-draw @textsurface_)|)_) ~(_bind @set-left-text &" text"(|~(_chop @left-container_) ~(_cram ~(_format-text @text_) @left-container_) ~(_force-draw @textsurface_)|)_) ~(_bind @set-bottom-text &" text"(|~(_chop @bottom-container_) ~(_cram ~(_format-text @text_) @bottom-container_) ~(_force-draw @textsurface_)|)_) ~(_bind @readpoem &(|~(_do-on-every-for &" n"(|~(_bind @words ~(_util:nth-from ~(_modulo @n @numpoemlines_) @poemtext_)_) ~(_bind @whichside ~(_modulo @n #4_)_) ~(|first-non-nil ~(_if ~(_::eq:: @whichside #0_) ~(_set-right-text @words_)_) ~(_if ~(_::eq:: @whichside #1_) ~(_set-bottom-text @words_)_) ~(_if ~(_::eq:: @whichside #2_) ~(_set-left-text @words_)_) ~(_if ~(_::eq:: @whichside #3_) ~(_set-top-text @words_)_)|) ~(_::pl:: @n #1_)|) #0 #1000 ~(_::ti:: @numpoemlines #3_)_)|)_) [doc](_[line](_[word](_[letter]"C" [letter]"a" [letter]"n" [letter]"v" [letter]"a" [letter]"s"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"u" [letter]"f" [letter]"f"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"l" [letter]"o" [letter]"w"_) [separator]"."_)_) ~(_bind @canvaswidth %500_) ~(_bind @canvasheight %500_) ~(_bind @maxradius %200_) ~(_bind @canvas ~(_instantiate ^<`Canvas`> ~(_to-integer @canvaswidth_) ~(_to-integer @canvasheight_)_)_) ~(_bind @centeroffset ~(_instantiate ^<`Vector`> ~(_::ov:: @canvaswidth %2_) ~(_::ov:: @canvasheight %2_)_)_) ~(_bind @position ~(_instantiate ^<`Vector`> %0 %0_)_) ~(_bind @reset-canvas &(|~(_@<`fill-background`>canvas (|#0 #0 #0|)_) ~(_bind @position ~(_instantiate ^<`Vector`> %0 %0_)_)|)_) ~(_bind @directions ~(|make-org ~(_add-tag ~(_<`right`>instantiate ^<`Vector`> %5 %0_) $"right"_) ~(_add-tag ~(_<`left`>instantiate ^<`Vector`> %-5 %0_) $"left"_) ~(_add-tag ~(_<`down`>instantiate ^<`Vector`> %0 %5_) $"down"_) ~(_add-tag ~(_<`up`>instantiate ^<`Vector`> %0 %-5_) $"up"_)|)_) ~(_bind @constructprobs &" rotateby"(|~(_let @probs1 ~(|map-with @directions &" d"(|${the position plus d (delta) gives you a distance from the origin.
divide by max radius allowed,
then
plug into the formula:
(1-x)^(1/100) which is mostly flat
but falls off sharply as you approach 1.
this gives you probability of this
distance being chosen, but you have to normalize it.} ~(_let @drotated ~(_@<`rotate`>d @rotateby_)_) ~(_let @where ~(_@<`add`>drotated @position_)_) ~(_let @radius ~(_@<`magnitude`>where_)_) ~(_let @radprob ~(_power ~(_- %1 ~(_::ov:: @radius @maxradius_)_) ~(_::ov:: %1 %100_)_)_) ~(_cons @radprob ~(_cons @where (||)_)_)|)|)_) ~(_let @total ~(_reduce-with-starting @probs1 &" item val"(|~(_::pl:: ~(_car @item_) @val_)|) %0_)_) ~(_map-with @probs1 &" item"(|~(_let @second ~(_car ~(_cdr @item_)_)_) ~(_let @norm ~(_::ov:: ~(_car @item_) @total_)_) ~(_cons @norm ~(_cons @second (||)_)_)|)_)|)_) ~(_bind @chooseoption &" options"(|~(_let @chosen ^_) ~(_let @r ~(_random _)_) ~(_reduce-with-starting @options &" item val"(|~(_let @prob ~(_first @item_)_) ~(_let @nextval ~(_::pl:: @val @prob_)_) ~(|if ~(_and ~(_::gte:: @r @val_) ~(_::lt:: @r @nextval_)_) ~(_set @chosen ~(_util:second @item_)_)|) @nextval|) %0_) @chosen|)_) ~(_bind @dostep &" rotateby%"(|~(_let @newposition ~(_chooseoption ~(_constructprobs @rotateby_)_)_) ~(_let @drawstart ~(_@<`add`>position @centeroffset_)_) ~(_let @drawend ~(_@<`add`>newposition @centeroffset_)_) ~(|@<`line`>canvas (|#255 #255 #255|) ~(_to-integer @<`x`>drawstart_) ~(_to-integer @<`y`>drawstart_) ~(_to-integer @<`x`>drawend_) ~(_to-integer @<`y`>drawend_)|) ~(_set @position @newposition_)|)_) ~(_bind @randomwalk &(|~(|animation:do-on-every &" theta"(|~(_dostep @theta_) ~(_::pl:: @theta %0.001_)|) %0 #1|)|)_) ~(_bind @setup-and-get-root &(|~(_setup-text _) ~(_reset-canvas _) ~(_bind @paddingcontainer ~(_style:with-padding-of (||) #30_)_) ~(_cons ~(_make-zlist @canvas @textsurface_) @paddingcontainer_)|)_) ~(_bind @start &(|~(_make-org ~(_ff ~(_readpoem _)_) ~(_ff ~(_randomwalk _)_)_)|)_)|)|)