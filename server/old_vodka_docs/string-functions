v2:~(|package @string ~(_import @util-functions_) ~(_bind @substring-from-with-length-deprecated &" str start len"(|~(_let @pos #-1_) ~(_let @end ~(_::pl:: @start @len_)_) ~(|reduce-with-starting ~(_string-listify @str_) &" item accum"(|~(_set @pos ~(_::pl:: @pos #1_)_) ~(|if ~(_and ~(_::gte:: @pos @start_) ~(_::lt:: @pos @end_)_) ~(_string-cat @accum @item_) @accum|)|) $|)|)_) ~(_bind @join-on-deprecated &" strlist separator"(|~(|reduce-with-starting @strlist &" item accum"(|~(|if ~(_is-nil @accum_) @item ~(_string-cat @accum @separator @item_)|)|) ^|)|)_) ~(_bind @split-on-deprecated &" str on"(|~(_let @result [word](__)_) ~(_let @str ~(_string-cat @str @on_)_) ~(|reduce-with-starting ~(_string-listify @str_) &" item accum"(|~(|if ~(_equal @item @on_) ~(|begin ~(_set @result ~(_cons @accum @result_)_) $|) ~(_string-cat @accum @item_)|)|) $|) ~(_util:reverse @result_)|)_)|)